# 第四阶段测试说明

## 安装依赖

在运行之前，请先安装新的依赖：

```bash
npm install chokidar
```

## 功能测试

### 1. 文件拖放测试

**操作步骤**:
1. 运行 `npm start` 启动应用
2. 从桌面或文件管理器拖动文件到精灵窗口
3. 观察效果：
   - 拖入时窗口显示粉色边框提示
   - 释放时精灵播放"吃东西"动画
   - 控制台输出文件信息

**预期结果**:
- 支持拖放多个文件
- 文件信息保存到配置文件
- 精灵有视觉反馈

### 2. 桌面文件监控测试

**操作步骤**:
1. 启动应用后
2. 在桌面上创建新文件或文件夹
3. 删除桌面上的文件
4. 修改桌面文件

**预期结果**:
- 控制台输出文件变化事件
- 显示文件名和操作类型（add/unlink/change）

### 3. 读取桌面文件列表

在浏览器控制台（托盘 -> 开发者工具）执行：

```javascript
// 获取桌面路径
const desktopPath = await window.electronAPI.getDesktopPath();
console.log('桌面路径:', desktopPath);

// 读取桌面文件列表
const result = await window.electronAPI.readDesktopFiles();
console.log('桌面文件:', result);
```

## 配置选项

配置文件位置: `%APPDATA%/moe-gui/config.json`

```json
{
  "enableFileWatcher": true,  // 是否启用桌面监控
  "windowPosition": { "x": 100, "y": 100 },
  "droppedFiles": []  // 拖放文件记录
}
```

## 注意事项

1. **文件监控**: 默认只监控桌面顶层，不递归子文件夹
2. **稳定性**: 文件需要稳定 2 秒后才触发事件（避免临时文件）
3. **性能**: 隐藏文件（以 . 开头）被忽略
4. **拖放**: 必须拖动到精灵窗口才能触发，透明区域无效

## 下一步

第五阶段将接入 AI，实现智能文件分类整理功能。
